var socket=io();$("button").click(function(){return socket.emit("move selected",$(this).val()),!1}),socket.on("move selected",function(e){$("#actions").append($("<li>").text(e))}),$(document).ready(function(){function e(e){for(var t=window.location.search.substring(1),o=t.split("&"),a=0;a<o.length;a++){var n=o[a].split("=");if(n[0]==e)return n[1]}return!1}function t(e,t){$.ajax({async:!1,global:!1,url:"js/pokemon.json",dataType:"json",success:function(e){poke=e}});var o=new Object;return o.id=poke[e].id,o.name=poke[e].name,o.hp=Math.floor((2*poke[e].stats.hp+193)*t/100+5),o.atk=Math.floor(((2*poke[e].stats.attack+193)*t/100+10)*t/100+20),o.def=Math.floor((2*poke[e].stats.defense+193)*t/100+10),o.spa=Math.floor(((2*poke[e].stats.spattack+193)*t/100+10)*t/100),o.spd=Math.floor((2*poke[e].stats.spdefense+193)*t/100+10),o.spe=Math.floor((2*poke[e].stats.speed+193)*t/100+10),o}function o(e,t){$.ajax({async:!1,global:!1,url:"js/pokemon.json",dataType:"json",success:function(e){themoves=e}});var o=0,a=new Object,n=themoves[e].moves.level;return n.forEach(function(n){themoves[e].moves.level[o].learnedat<=t&&(a[o]=themoves[e].moves.level[o].name.toUpperCase()),o++}),a}function a(){$(".item-menu, .pkmn-menu, .fight-menu").css("display","none"),$("p.text1").text(" "),$("p.text2").text(" "),$(".menu").css("display","block")}function n(){$(".menu, .item-menu, .pkmn-menu, .fight-menu").css("display","none")}function i(e,t){var o=e,a=t,n=100,i=o*n/a;return i}function s(){8>=C&&$(".foe .healthbar").css("background-color","red"),0>=C?($(".menu").css("display","none"),$(".foe .healthbar").css("width","0%"),window.setTimeout(function(){$(".foe .image").delay(500).animate({bottom:"-35.714em"},1e3),$("p.text1").text(b.name.toUpperCase()+" fainted!"),$("p.text2").text(""),_(),window.setTimeout(function(){$(".foe .stats").css("display","none"),$("p.text1").text("Got $"+Math.floor(2.5*d)+" for"),$("p.text2").text("winning!"),_(),window.setTimeout(function(){$("p.text1").text(k.toUpperCase()+": I can't"),$("p.text2").text("believe it!"),_(),window.setTimeout(function(){$("p.text1").text("I chose the"),$("p.text2").text("wrong POKeMON!"),_(),window.setTimeout(function(){$(".gameboy").hide(),$("footer").show()},2e3)},2e3)},2e3)},2e3)},2e3)):window.setTimeout(function(){$("p.text1").text(b.name.toUpperCase()+" used"),$("p.text2").text(O[Math.floor(3*Math.random())].toUpperCase()+"!"),_(),$(".foe .image").animate({left:"0.714em"},100,"linear").animate({left:"-1.429em"},50,"linear").delay(100).animate({left:"0.000em"},10,"linear"),window.setTimeout(function(){$(".player .image").css("opacity",0),window.setTimeout(function(){$(".player .image").css("opacity",1),window.setTimeout(function(){$(".player .image").css("opacity",0),window.setTimeout(function(){$(".player .image").css("opacity",1),window.setTimeout(function(){$(".player .image").css("opacity",0),window.setTimeout(function(){$(".player .image").css("opacity",1),window.setTimeout(function(){var e=40,t=Math.floor(Math.floor(Math.floor(2*d/5+2)*e*b.atk/h.def)/50)+2;y-=t,7>=y&&$(".player .healthbar").css("background-color","red"),0>=y?($(".menu").css("display","none"),$(".player .hp").text("0"),$(".player .healthbar").css("width","0%"),$(".player .stats").css("display","none"),window.setTimeout(function(){$(".player .image").delay(500).animate({bottom:"-35.714em"},1e3),$("p.text1").text(h.name.toUpperCase()+" fainted..."),$("p.text2").text(""),_(),window.setTimeout(function(){$("p.text1").text(m.toUpperCase()+" is out of"),$("p.text2").text("useable POKeMON..."),_(),window.setTimeout(function(){$("p.text1").text(m.toUpperCase()+" whited out!"),$("p.text2").text(" "),_(),window.setTimeout(function(){$(".gameboy").hide(),$("footer").show()},2e3)},2e3)},2e3)},2e3)):($(".player .hp").text(y),$(".player .healthbar").animate({width:i(y,w)+"%"},500),window.setTimeout(function(){a()},2400))},100)},100)},100)},100)},100)},100)},100)},2e3)}function l(){n(),$("p.text1").text(h.name.toUpperCase()),$("p.text2").text("used GROWL!"),_(),window.setTimeout(function(){M<b.def-20?($("p.text1").text(b.name.toUpperCase()+"'s defense"),$("p.text2").text("can't drop lower!"),_(),window.setTimeout(function(){s()},2e3)):($("p.text1").text(b.name.toUpperCase()+"'s defense"),$("p.text2").text("dropped by 2!"),_(),window.setTimeout(function(){s()},2e3))},2e3)}function c(e){n(),$("p.text1").text(h.name.toUpperCase()+" used"),$("p.text2").text(e.toUpperCase()+"!"),_(),$(".player .image").animate({left:"-0.714em"},100,"linear").animate({left:"1.429em"},50,"linear").delay(100).animate({left:"0.000em"},10,"linear"),window.setTimeout(function(){$(".foe .image").css("opacity",0),window.setTimeout(function(){$(".foe .image").css("opacity",1),window.setTimeout(function(){$(".foe .image").css("opacity",0),window.setTimeout(function(){$(".foe .image").css("opacity",1),window.setTimeout(function(){$(".foe .image").css("opacity",0),window.setTimeout(function(){$(".foe .image").css("opacity",1);var e=40,t=Math.floor(Math.floor(Math.floor(2*d/5+2)*e*h.atk/b.def)/50)+2;C-=t,$(".foe .healthbar").animate({width:i(C,T)+"%"},500),s()},100)},100)},100)},100)},100)},100)}function p(e){if(n(),"normal"==e)var t=20;else if("super"==e)var t=50;else if("hyper"==e)var t=200;else if("max"==e)var t=999;y>=w?($("p.text1").text("HP already"),$("p.text2").text("full!"),_(),window.setTimeout(function(){a()},1e3)):($("p.text1").text("Used POTION!"),$("p.text2").text(" "),_(),y+=t,y>=w&&(y=w),$(".player .hp").text(y),$(".player .healthbar").animate({width:i(y,w)+"%"},500),$(".player .healthbar").css("background-color","green"),P--,s()),$(".potionCount").text(P),0>=P&&$(".potion").css("display","none")}if(0!=e("color")){var r="bw";$("body").addClass("bw")}else var r="color";var m="Ash";if(0!=e("playerdex"))var f=e("playerdex");else var f=25;if(0!=e("foedex"))var u=e("foedex");else var u=133;if(0!=e("level"))var d=e("level"),x=e("level");else var d=5,x=5;var h=t(f,d),w=h.hp,y=w,g=h.atk,v=h.def;$(".player .level").text(d),$(".player .hp").text(w),$(".player .hpTotal").text(w),$(".player .name").text(h.name.toUpperCase()),$(".player .sprite").html("<img src='img/"+r+"/back/"+f+".gif'/>");var k="Gary",b=t(u,x),T=b.hp,C=T,U=b.atk,M=b.def;$(".foe .level").text(d),$(".foe .name").text(b.name.toUpperCase()),$(".foe .sprite").html("<img src='img/"+r+"/front/"+u+".gif'/>");var j=o(f,d),O=o(u,x);$("#move0").html(j[3]),$("#move1").html(j[2]),$("#move2").html(j[1]),$("#move3").html(j[0]);var _=function(){$("div.messages .text1, div.messages .text2").each(function(){$(this).text($(this).text().replace(/ /g,"Â "))});var e=$("div.messages .text1, div.messages .text2");e.hide().contents().each(function(){var e;e="<span> "+this.data.split("").join(" </span><span> ")+" </span>",$(this).replaceWith(e)}),e.find("span").hide().each(function(){$.trim(this.innerHTML)||$(this).remove()}),e.show().find("span").each(function(e){$(this).delay(40*e).fadeIn(0)})},P=1;$(".potionCount").text(P),$(".loader").animate({marginTop:"0.000em"},2e3,"linear"),window.setTimeout(function(){$(".loader").css("display","none"),$(".battle").css("display","block"),$(".sprite, .gary, .ash, .stats, .ash_balls, .gary_balls").css("display","none"),$(".foe .image").animate({right:"0.000em"},2e3,"linear"),$(".player .image").animate({left:"0.000em"},2e3,"linear"),window.setTimeout(function(){$(".gary, .ash, .ash_balls, .gary_balls").css("display","block"),$(".gary_black, .ash_black").css("display","none"),window.setTimeout(function(){$("p.text1").text(k.toUpperCase()+" wants"),$("p.text2").text("to fight!"),_(),window.setTimeout(function(){$(".ash_balls, .gary_balls").css("display","none"),$(".foe .image").animate({right:"-71.429em"},700,"linear"),window.setTimeout(function(){$("p.text1").text(k.toUpperCase()+" sent"),$("p.text2").text("out "+b.name.toUpperCase()+"!"),_(),$(".foe .sprite").css("display","block"),$(".gary").css("display","none"),$(".foe .image").animate({right:"0.000em"},1300,"linear"),window.setTimeout(function(){$(".foe .stats").css("display","block"),$(".player .image").animate({left:"-71.429em"},700,"linear"),window.setTimeout(function(){$(".ash").css("display","none"),$(".player .sprite").css("display","block"),$(".foe .stats").css("display","block"),$(".player .image").animate({left:"0.000em"},1300,"linear"),$("p.text1").text("Go! "+h.name.toUpperCase()+"!"),$("p.text2").text(" "),_(),$(".player .stats").css("display","block"),window.setTimeout(function(){a()},3e3)},1500)},2e3)},1e3)},2e3)},400)},2010)},3e3),$(".item").click(function(){$(".item-menu").css("display","block")}),$(".potion").click(function(){p("normal")}),$(".fight").click(function(){$(".fight-menu").css("display","block")}),$(".growl").click(function(){l()}),$("#move0").click(function(){c(j[3])}),$("#move1").click(function(){c(j[2])}),$("#move2").click(function(){c(j[1])}),$("#move3").click(function(){c(j[0])}),$(".back").click(function(){a()}),$(".pkmn").click(function(){$(".pkmn-menu").css("display","block")}),$(".run").click(function(){n(),$("p.text1").text("You can't run from"),$("p.text2").text("a POKeMON battle!"),_(),window.setTimeout(function(){a()},2e3)})});